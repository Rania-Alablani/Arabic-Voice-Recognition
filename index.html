<!doctype html>
<html>
<head>
  <title>لاقط صوتي</title>
<style>
body{
  background: #6894a1;
  margin: 0;
  padding: 0;
}
button{
  background-color: #7a162f ;
  border-style: none;
  border-radius: 5px;
  padding: 20px 30px;
  color: #ffffff;
}
#output{
  font-size: 30px;
}
.header a {
  float: left;
  color: black;
  text-align: center;
  padding: 12px;
  text-decoration: none;
  font-size: 18px;
  line-height: 25px;
  border-radius: 4px;
}


.header {
  overflow: hidden;
  background-color: #f1f1f1;
  padding: 20px 10px;
}

.header a.logo {
  font-size: 25px;
  font-weight: bold;
}
</style>
</head>
<body>
  <div class="header">
      <a class="logo" href="#"><img src="https://s-m.com.sa/ar/images/logo.png" alt="logo" /></a>
</div>
<audio id="voice">
	<source id="sound" src="1.mp3" type="audio/mp3">
</audio>

<audio id="voice1">
	<source id="sound" src="2.mp3" type="audio/mp3">
</audio>

<p id="demo"></p>

<script>
window.addEventListener('load', function(){
	var a = document.getElementById("voice");
	var b = document.getElementById("voice1");
	var c = null;

    getXmlHttpRequestObject = function(){
        if(!c){
            c = new XMLHttpRequest();
        }
        return c;
    };

    function evenHandler(){
        if(c.readyState == 4 && c.status == 200){
            dataDiv = document.getElementById('liveData');
            dataDiv.innerHTML = c.responseText;
			var b=c.responseText;

			if(b==1){
				a.play();
				output.classList.add("hidden");
				var y = document.getElementById("voice").duration;
				y=(y*1000);
				console.log(y);
				document.getElementById("demo").innerHTML = y;
				document.getElementById("p1").style.display = "block";
				document.getElementById("p2").style.display = "none";
				setTimeout(function(){ document.getElementById("p1").style.display = "none"; document.getElementById("p2").style.display = "block";}, y);
			}

			document.getElementById("sound").src=c.responseText;
        }
    }

	function stt(){
		var output = document.getElementById("output");
		var action = document.getElementById("act");

        var SpeechRecognition = SpeechRecognition || webkitSpeechRecognition;
        var recognition = new SpeechRecognition();

        recognition.onstart = function() {
            action.innerHTML = "<small>أنا اسمعك، تكلم معي</small>";
        };

        recognition.onspeechend = function() {
            action.innerHTML = "<small>توقفت عن الاستماع</small>";
            recognition.stop();
        }

        recognition.onresult = function(event) {
          var transcript = event.results[0][0].transcript;
			    var confidence = event.results[0][0].confidence;
            output.innerHTML = "<b></b> " + transcript;

            output.classList.remove("hidden");

				x2.play();
				var yy = document.getElementById("voice1").duration;
				yy=yy*1000;
				console.log(yy);
				document.getElementById("demo").innerHTML = yy;
				document.getElementById("p1").style.display = "block";
				document.getElementById("p2").style.display = "none";
				setTimeout(function(){ document.getElementById("p1").style.display = "none"; document.getElementById("p2").style.display = "block";}, yy);
        };
        recognition.start();
	}
});

	function stt(){
		var output = document.getElementById("output");
		var action = document.getElementById("act");

        var SpeechRecognition = SpeechRecognition || webkitSpeechRecognition;
        var recognition = new SpeechRecognition();

        recognition.onstart = function() {
            action.innerHTML = "<small>أنا اسمعك، تكلم معي</small>";
        };

        recognition.onspeechend = function() {
            action.innerHTML = "<small>توقفت عن الاستماع</small>";
            recognition.stop();
        }

        recognition.onresult = function(event) {
            var transcript = event.results[0][0].transcript;
			      var confidence = event.results[0][0].confidence;

            output.innerHTML = "<b></b> " + transcript;
            output.classList.remove("hidden");

				x2.play();
				var a1 = document.getElementById("voice1").duration;
				a1=a1*1000;
				console.log(yy);
				document.getElementById("demo").innerHTML = a1;
				document.getElementById("p1").style.display = "block";
				document.getElementById("p2").style.display = "none";
				setTimeout(function(){ document.getElementById("p1").style.display = "none"; document.getElementById("p2").style.display = "block";}, yy);
        };
        recognition.start();
	}

function playSound(){
  var x = document.getElementById("voice");
  x.play();
  var y = document.getElementById("voice").duration;
  y=y*1000;
  document.getElementById("demo").innerHTML = y;
  document.getElementById("p1").style.display = "block";
  document.getElementById("p2").style.display = "none";
  setTimeout(function(){ document.getElementById("p1").style.display = "none"; document.getElementById("p2").style.display = "block";}, y);
}
</script>
<div align="center">
<br>

	<button onclick="stt()">أبدأ</button>

    <p><span id="act"></span></p>
    <div id="output" class="hide" ></div>
</div>
</body>
</html>
